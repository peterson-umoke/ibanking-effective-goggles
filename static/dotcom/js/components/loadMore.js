define(["jquery","../util/url"],function(a,t){function e(t){a(t).hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")})}return function(r,n,o,i,d,s,l){var c=a(r),u=c.find(o),f=c.find(i),h=c.find(s);!u.length>0||f.click(function(){var r=c.find(d),o=c.find(n),i=f.attr("data-action"),s=f.attr("data-query-parameters");a.ajax({url:i,type:"GET",dataType:"json"}).done(function(a){s&&t.replaceParams(s);var n=a.listItems,i=a.listingCountMessage;f.attr("data-action",a.loadMoreDataAction),f.attr("data-query-parameters",a.loadMoreQueryParameters),f.html(a.loadMoreCaption),r.replaceWith(i),void 0!==l?l(n):o.append(n),a.loadMoreDataAction||f.addClass("hidden"),o.find(".download-hover-overlay").each(function(a,t){e(t)})}).error(function(a){h.html(a.responseJSON.errorMessage)})})}});